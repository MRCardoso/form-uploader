!function(){"use strict";angular.module("form.uploader",["angularFileUpload","ngThumbCanvas"]).run(["$rootScope",function(e){}])}(),angular.module("form.uploader").run(["$templateCache",function(e){e.put("form-uploader-simple.html",'\n<div ng-repeat="(type, msg) in messages">\n    <div ng-show="msg" class="alert alert-{{type}} alert-dismissible flash" role="alert">\n        <button type="button" ng-click="cleanMessage(type)" class="close">\n            <span aria-hidden="true">&times;</span>\n        </button>\n        <strong>\n            <i ng-class="{\'fa-warning\': type==\'danger\', \'fa-info\': type==\'info\', \'fa-check\': type==\'success\'}" class="fa"></i>\n        </strong>\n        {{msg}}\n    </div>\n</div>\n\n<div class="clear"></div>\n\n<div class="text-center">\n    <input type="file" ng-if="many" multiple id="file" custom-change="onChangeFile" ng-hide="true">\n    <input type="file" ng-if="!many" id="file" custom-change="onChangeFile" ng-hide="true">\n    <div class="upFile" data-id="default" role="button">\n        <div ng-click="openFile()">\n            <div over-class="another-file-over" class="well my-drop-zone">\n                Arrate aqui ou clique para efetuar o upload\n                <i class="fa fa-upload"></i>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div ng-repeat="item in fileItems">\n    <div class="file-group-item">\n        <div class="col-md-3">\n            <button type="button" uib-tooltip="Remover" class="btn btn-danger btn-xs" ng-click="deleteItem(item)">\n                <span class="glyphicon glyphicon-remove"></span>\n            </button>\n        </div>\n\n        <div class="col-md-2 text-center">\n            <div ng-show="isImage(true, item.file)" ng-thumb="{ file: item.file, height: 80 }"></div>\n            <i class="glyphicon glyphicon-file" ng-hide="isImage(true, item.file)"></i>\n        </div>\n        <div class="col-md-4 text-center">\n            <div class="force-text" ng-bind="item.file.name| shortName:17:true" uib-tooltip="{{item.file.name}}"></div>\n        </div>\n        <div class="col-md-1">\n            <span tooltip="Size" tooltip-placement="top" tooltip-trigger="mouseenter" ng-show="true" nowrap>\n                {{ item.file.size/1024/1024|number:2 }} MB\n            </span>\n        </div>\n        <div class="col-md-2">\n            <div ng-show="true">\n                <div class="progress" style="margin-bottom: 0;">\n                    <div class="progress-bar" role="progressbar" ng-style="{ \'width\': item.progress + \'%\' }">\n                        {{item.progress + \'%\'}}\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="clear"></div>\n    </div>\n</div>'),e.put("form-uploader.html",'<div ng-if="uploader" class="form-uploader-container">\n    <div ng-repeat="(type, msg) in messages">\n        <div ng-show="msg" class="alert alert-{{type}} alert-dismissible flash" role="alert">\n            <button type="button" ng-click="cleanMessage(type)" class="close">\n                <span aria-hidden="true">&times;</span>\n            </button>\n            <strong>\n                <i ng-class="{\'fa-warning\': type==\'danger\', \'fa-info\': type==\'info\', \'fa-check\': type==\'success\'}" class="fa"></i>\n            </strong>\n            {{msg}}\n        </div>\n    </div>\n\n    <div class="clear"></div>\n\n    <div class="text-center">\n        <input type="file" nv-file-select multiple uploader="uploader" id="file" ng-hide="true">\n        <div ng-show="uploader.isHTML5" class="upFile" data-id="default" role="button">\n            <div nv-file-drop="" uploader="uploader" ng-click="openFile()">\n                <div nv-file-over="file-over" uploader="uploader" over-class="another-file-over" class="well my-drop-zone">\n                    Arrate aqui ou clique para efetuar o upload\n                    <i class="fa fa-upload"></i>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div ng-show="uploader.queue.length>1">\n        <div class="file-group">\n            <div class="col-md-4">\n                <button type="button" class="btn btn-success btn-xs" ng-click="uploader.uploadAll()" ng-disabled="!uploader.getNotUploadedItems().length"\n                        uib-tooltip="Enviar tudo" uib-tooltip-placement="top" uib-tooltip-trigger="mouseenter">\n                    <span class="glyphicon glyphicon-upload"></span>\n                </button>\n                <button type="button" class="btn btn-warning btn-xs" ng-click="uploader.cancelAll()" ng-disabled="!uploader.isUploading"\n                        uib-tooltip="Cancelar tudo" uib-tooltip-placement="top" uib-tooltip-trigger="mouseenter">\n                    <span class="glyphicon glyphicon-ban-circle"></span>\n                </button>\n                <button type="button" class="btn btn-danger btn-xs" ng-click="deleteAll(uploader)" ng-disabled="!uploader.queue.length"\n                        uib-tooltip="Remover tudo" uib-tooltip-placement="top" uib-tooltip-trigger="mouseenter">\n                    <span class="glyphicon glyphicon-remove"></span>\n                </button>\n\n                <div class="badge pull-right">\n                    Total de arquivos: {{uploader.queue.length}}\n                </div>\n            </div>\n            <div class="col-md-8">\n                <div ng-show="uploader.isHTML5">\n                    <div class="progress" style="margin-bottom: 0;">\n                        <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader.progress + \'%\' }">{{ uploader.progress + \'%\'}}</div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="clear"></div>\n        </div>\n    </div>\n\n    <div class="file-group" ng-show="uploader.queue.length>0">\n        <div ng-repeat="item in uploader.queue" class="file-group-item">\n            <div class="badge pull-left">\n                <span tooltip="Size" tooltip-placement="top" tooltip-trigger="mouseenter" ng-show="uploader.isHTML5" nowrap>\n                    {{ item.file.size/1024/1024|number:2 }} MB\n                </span>\n            </div>\n            <div class="text-right">\n                <button type="button" class="btn btn-success btn-xs" uib-tooltip="Enviar" ng-click="item.upload()" ng-disabled="item.isReady || item.isUploading || item.isSuccess">\n                    <span class="glyphicon glyphicon-upload"></span>\n                </button>\n                <button type="button" class="btn btn-warning btn-xs" uib-tooltip="Cancelar" ng-click="item.cancel()" ng-disabled="!item.isUploading">\n                    <span class="glyphicon glyphicon-ban-circle"></span>\n                </button>\n                <button type="button" uib-tooltip="Remover" class="btn btn-danger btn-xs" ng-click="deleteItem(item)">\n                    <span class="glyphicon glyphicon-remove"></span>\n                </button>\n                \n                <i ng-show="item.showLoading" class="loader glyphicon glyphicon-repeat"></i>\n\n                <span uib-tooltip="Progresso bem-sucedido" class="label label-success" ng-show="item.isSuccess">\n                    <i class="glyphicon glyphicon-ok"></i>\n                </span>\n                <span uib-tooltip="Progresso cancelado" class="label label-warning" ng-show="item.isCancel">\n                    <i class="glyphicon glyphicon-ban-circle"></i>\n                </span>\n                <span uib-tooltip="Erro no progresso" class="label label-danger" ng-show="item.isError">\n                    <i class="glyphicon glyphicon-alert"></i>\n                </span>\n            </div>\n\n            <div class="text-center" uib-tooltip="{{item.file.name}}">\n                <div ng-switch="isImage(uploader.isHTML5, item.file)">\n                    <div ng-switch-when="true" class="image-preview" ng-mouseover="hoverCrop = true" ng-mouseleave="hoverCrop = false">\n                        <i class="fa fa-cut" ng-show="hoverCrop"></i>\n                        <div ng-click="setInstance(item,$event)" data-toggle="modal" data-target="#modal-crop" ng-thumb="{file: item._file, height: 80}"></div>\n                    </div>\n                    <i ng-switch-when="false" class="glyphicon glyphicon-file"></i>\n                    \n                    <div ng-show="uploader.isHTML5">\n                        <div class="progress" style="margin-bottom: 0;">\n                            <div class="progress-bar" role="progressbar" ng-style="{ \'width\': item.progress + \'%\' }">\n                                {{item.progress + \'%\'}}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n\x3c!-- Modal --\x3e\n<div class="modal fade" id="modal-crop" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">\n    <div class="modal-dialog" role="document">\n        <div class="modal-content">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n                <h4 class="modal-title" id="myModalLabel">Cortar imagem</h4>\n            </div>\n            <div class="modal-body">\n                \x3c!-- Nav tabs --\x3e\n                <ul class="nav nav-tabs nav-justified" role="tablist">\n                    <li role="presentation" class="active">\n                        <a role="tab" data-target="#crop" data-toggle="tab">Corte</a>\n                    </li>\n                    <li role="presentation">\n                        <a role="tab" data-target="#preview" data-toggle="tab">Pre-visualização</a>\n                    </li>\n                </ul>\n                \x3c!-- Tab panes --\x3e\n                <div class="tab-content">\n                    <div role="tabpanel" class="tab-pane active" id="crop">\n                        <div class="cropArea">\n                            <img-crop image="cropImage" result-image="cropImageResult" area-type="square" area-min-size="50" result-image-quality="1.0"\n                                result-image-size="cropSize"></img-crop>\n                        </div>\n                    </div>\n                    <div role="tabpanel" class="tab-pane" id="preview">\n                        <img ng-src="{{cropImageResult}}" width="100%" height="350" />\n                    </div>\n                </div>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>\n                <button type="button" class="btn btn-primary" ng-click="saveCrop()">Salvar</button>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("ngThumbCanvas",[]).directive("ngThumb",["$window",function(n){console.log("bennngn");var s=!(!n.FileReader||!n.CanvasRenderingContext2D),r=function(e){return angular.isObject(e)&&e instanceof n.File},d=function(e){var n="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(n)};return{restrict:"A",template:"<canvas/>",link:function(e,n,i){if(s){var a=e.$eval(i.ngThumb);if(r(a.file)&&d(a.file)){var t=n.find("canvas"),l=new FileReader;l.onload=function(e){var n=new Image;n.onload=o,n.src=e.target.result},l.readAsDataURL(a.file)}}function o(){var e=a.width||this.width/this.height*a.height,n=a.height||this.height/this.width*a.width;t.attr({width:e,height:n}),t[0].getContext("2d").drawImage(this,0,0,e,n)}}}}]),angular.module("form.uploader").directive("customChange",[function(){return{restrict:"A",link:function(e,n,i,a){var t=e.$eval(i.customChange);n.bind("change",t)}}}]).directive("formUploader",function(){return{restrict:"E",templateUrl:function(e,n){return!angular.isUndefined(n.uploadOnSubmit)&&n.uploadOnSubmit?"form-uploader-simple.html":"form-uploader.html"},scope:{many:"=?many",allowType:"@allowType",validators:"=?validators",defaultLimit:"=?defaultLimit",removeUrl:"=?removeUrl",sendUrl:"=?sendUrl",uploadOnSubmit:"=?uploadOnSubmit"},controller:["$scope","FileUploader","$http","$filter",function(s,e,i,a){if(angular.isUndefined(s.sendUrl))return console.warn("Por Favor, Defina uma 'url' para este upload");var t=[];s.fileItems=[],s.onChangeFile=function(e){for(var n=[],i=0;i<e.target.files.length;i++){var a=e.target.files[i];n.push({name:a.name,size:a.size,type:a.type,file:a})}s.fileItems=n,s.$digest(),console.log(n)};var r=null;s.messages={danger:null,success:null,info:null},s.many=!angular.isUndefined(s.many)&&s.many,s.validators=angular.isUndefined(s.validators)?[]:s.validators,s.removeUrl=angular.isUndefined(s.removeUrl)?null:s.removeUrl,s.defaultLimit=angular.isUndefined(s.defaultLimit)?3145728:s.defaultLimit,s.uploadOnSubmit=!angular.isUndefined(s.uploadOnSubmit)&&s.uploadOnSubmit,s.cleanMessage=function(e){s.messages[e]=null},s.openFile=function(){var e=angular.element;e(document).off("click.upFile").on("click.upFile",".upFile",function(){e("#file").off("click").trigger("click")})},s.isImage=function(e,n){return!!/(gif|jpg|jpeg|png|x-png|pjpeg)/.test(n.type)&&e},s.deleteItem=function(n){"uploadedPath"in n&&null!=s.removeUrl?(n.showLoading=!0,l([n.uploadedPath],function(e){n.showLoading=!1,s.messages.success=e.data.message,n.remove()})):n.remove()},s.deleteAll=function(n){0<t.length&&null!=s.removeUrl?l(t,function(e){t=[],s.messages.success=e.data.message,n.clearQueue()}):n.clearQueue()},s.setInstance=function(e,n){s.cropImage="",s.cropImageResult="",s.cropSize=600,(r=e).element=n;var i=new FileReader;i.onload=function(n){s.$apply(function(){s.cropImage=n.target.result;var e=new Image;e.onload=function(){s.cropSize=this.width},e.src=s.cropImage,delete e})},i.readAsDataURL(e._file)},s.saveCrop=function(){for(var e=s.cropImageResult.split(","),n=atob(e[1]),i=n.length,a=new Uint8Array(i);i--;)a[i]=n.charCodeAt(i);var t=r.element.target,l=new File([a],r.file.name,{type:r.file.type}),o=new Image;o.onload=function(){t.getContext("2d").drawImage(this,0,0,t.width,t.height)},o.src=s.cropImageResult,r._file=l,angular.element(document.getElementById("modal-crop")).modal("hide"),delete o};var l=function(e,n){i.post(s.removeUrl,{Keys:e}).then(function(e){n(e)},function(e){s.messages.danger=e.data.message})},n=s.uploader=new e({url:s.sendUrl,queueLimit:s.defaultLimit}),o=s.validators;angular.isUndefined(s.allowType)||o.push({name:"typeAllow",fn:function(e,n){var i=new RegExp(s.allowType,"i").test(e.name);return i||(s.messages.info="Extensão inválida, o arquivo deve ser '"+s.allowType.replace(/(\|)/gi,", ")+"'"),i}}),o.push({name:"sizeAllow",fn:function(e,n){var i=e.size>s.defaultLimit;return i&&(s.messages.info="O arquivo excedeu o tamanho máximo permitido "+a("number")(s.defaultLimit,2)+"MB"),!i}}),n.filters=o,n.onAfterAddingFile=function(e){s.many||1<e.uploader.queue.length&&(e.uploader.queue=[e.uploader.queue[e.uploader.queue.length-1]])},n.onBeforeUploadItem=function(e){e.showLoading=!0,s.$root.$broadcast("form.uploader.begin")},n.onCancelItem=function(e,n,i,a){s.messages.info="Envio abortado com sucess!"},n.onCompleteItem=function(e,n,i,a){e.showLoading=!1,0!=i&&""!=n&&(200==i?(e.uploadedPath=n.path,t.push(n.path),s.messages.success=n.message):s.messages.danger=n.message),s.$root.$broadcast("form.uploader.finish",n)}}]}}),angular.module("form.uploader").filter("shortName",function(){return function(e,n,i){if(n=n||20,i=!!angular.isDefined(i)&&i,20<e.length){var a=e.substr(0,n);if(i)a+=["...(.",e.split(".").pop(),")"].join("");return a}return e}});